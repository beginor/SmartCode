@using SmartCode
@using SmartCode.Db
@model BuildContext
@{
    var project = Model.Project;
    var dbSource = Model.GetDataSource<DbSource>();
    var table = Model.GetCurrentTable();

    var resultMapName = $"{table.ConvertedName}ResultMap";

    var buildTask = Model.Build;

    var pkCol = table.PKColumn;
    if (pkCol == null)
    {
        throw new SmartCodeException($"{table.Name} can not find PKColumn！");
    }
    
    if (!project.BuildTasks.TryGetValue("Entity", out var entityBuild))
    {
        throw new ArgumentException("can not find Project -> BuildTasks -> [Entity] .");
    }

    var entityName = $"{project.Module}.{entityBuild.Module}.{table.ConvertedName}";
}

<resultMap id="@resultMapName" type="@entityName">
    <id column="@pkCol.Name" property="@pkCol.ConvertedName"></id>
    @foreach (var col in table.Columns)
    {
        if (col.IsPrimaryKey)
        {
            continue;
        }
        <result column="@col.Name" property="@col.ConvertedName"/>
    }
</resultMap>